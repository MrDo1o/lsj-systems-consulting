---
interface RegistryRecord {
	title: string;
	year?: string;
	type: string;
	role?: string;
	scope: string;
	status: string;
	documentation?: string;
}

interface HeroAsset {
	src: string;
	alt: string;
	label: string;
}

interface Props {
	view?: 'home' | 'gallery';
	kicker?: string;
	headline?: string;
	inscription?: string;
	primaryLabel?: string;
	primaryHref?: string;
	contactLabel?: string;
	contactHref?: string;
	registryLabel?: string;
	records?: RegistryRecord[];
	selectedRecords?: RegistryRecord[];
	heroAssets?: HeroAsset[];
}

const {
	view = 'home',
	kicker = 'LSJ Systems (est. 2024)',
	headline = 'Digital Architecture',
	inscription = 'What endures is built deliberately.',
	primaryLabel = 'Begin',
	primaryHref = 'mailto:hello@lsjsystems.com?subject=Begin',
	contactLabel = 'hello@lsjsystems.com',
	contactHref = 'mailto:hello@lsjsystems.com',
	registryLabel = 'Public Registry',
	records = [
		{
			title: 'CALLMEISRAEL, 2026',
			year: '2026',
			type: 'Digital Architecture',
			role: 'Implementation',
			scope: 'Commissioned structure for performance archive',
			status: 'Active. 2026.01',
			documentation: 'Access log, release protocol, and archival container map.'
		}
	],
	selectedRecords = records.slice(0, Math.min(records.length, 2)),
	heroAssets = []
} = Astro.props;

const isGallery = view === 'gallery';

const taxonomy = {
	years: [...new Set(records.map((record) => record.year).filter(Boolean))],
	types: [...new Set(records.map((record) => record.type))],
	statuses: [...new Set(records.map((record) => record.status.split('.')[0]))],
	roles: [...new Set(records.map((record) => record.role).filter(Boolean))]
};
---

<div id="container" data-view={view}>
	<main>
		<header id="masthead" aria-label="Primary navigation">
			<p class="wordmark" aria-label="LSJ">LSJ</p>
			<nav class="primary-nav">
				<a href="/gallery">Work</a>
				<a href="/intake">Intake</a>
				<a href="/engagement">Engagement</a>
				<a href="/vault">Vault</a>
			</nav>
		</header>

		<section id="hero" aria-label="LSJ introduction">
			<p class="meta">{kicker}</p>
			<h1>{headline}</h1>
			<p class="inscription">{inscription}</p>
			<div id="actions">
				<a class="button" href={primaryHref}>{primaryLabel}</a>
				<a class="contact" href={contactHref}>{contactLabel}</a>
			</div>
		</section>

		<section id="hero-media" aria-label="Featured hero stills">
			{heroAssets.length > 0 ? (
				<div class="hero-media-grid">
					{heroAssets.map((asset, index) => (
						<figure class:list={["media-frame", { "media-frame-secondary": index > 0 }]}>
							<img src={asset.src} alt={asset.alt} loading={index === 0 ? 'eager' : 'lazy'} />
							<figcaption>{asset.label}</figcaption>
						</figure>
					))}
				</div>
			) : (
				<div class="media-fallback" aria-hidden="true">
					<p>Hero-01 / Hero-02 pending upload</p>
				</div>
			)}
		</section>

		<section id="registry" aria-label="Public registry preview">
			<div class="registry-topline">
				<p class="meta">{registryLabel}</p>
				{isGallery && <p class="meta meta-soft">Published records: {records.length}</p>}
			</div>

			{isGallery && (
				<section class="taxonomy" aria-label="Archive index and taxonomy">
					<p class="meta">Archive Index</p>
					<div class="filters">
						<div class="filter-group">
							<p class="filter-label">Year</p>
							<div class="chips">{taxonomy.years.map((item) => <span class="chip">{item}</span>)}</div>
						</div>
						<div class="filter-group">
							<p class="filter-label">Type</p>
							<div class="chips">{taxonomy.types.map((item) => <span class="chip">{item}</span>)}</div>
						</div>
						<div class="filter-group">
							<p class="filter-label">Status</p>
							<div class="chips">{taxonomy.statuses.map((item) => <span class="chip">{item}</span>)}</div>
						</div>
						<div class="filter-group">
							<p class="filter-label">Role</p>
							<div class="chips">{taxonomy.roles.map((item) => <span class="chip">{item}</span>)}</div>
						</div>
					</div>
				</section>
			)}

			<div class="records" role="list">
				{
					records.map((record) => (
						<article class="record" role="listitem">
							<p class="record-kicker">{record.title}</p>
							<p class="record-line"><span>Year</span><span>{record.year ?? '—'}</span></p>
							<p class="record-line"><span>Type</span><span>{record.type}</span></p>
							<p class="record-line"><span>Status</span><span>{record.status}</span></p>
							<p class="record-line"><span>Role</span><span>{record.role ?? '—'}</span></p>
							<p class="record-line"><span>Scope</span><span>{record.scope}</span></p>
						</article>
					))
				}
			</div>
			<p class="inscription inscription-secondary">{inscription}</p>
		</section>

		{isGallery && (
			<section id="selected-records" aria-label="Selected records with documentation">
				<div class="registry-topline">
					<p class="meta">Selected Records</p>
					<p class="meta meta-soft">Deeper Documentation</p>
				</div>
				<div class="selected-grid">
					{
						selectedRecords.map((record) => (
							<article class="selected-item">
								<p class="record-kicker">{record.title}</p>
								<p class="record-line"><span>Type</span><span>{record.type}</span></p>
								<p class="record-line"><span>Role</span><span>{record.role ?? '—'}</span></p>
								<p class="record-line"><span>Status</span><span>{record.status}</span></p>
								<p class="record-line"><span>Documentation</span><span>{record.documentation ?? 'File available on request.'}</span></p>
							</article>
						))
					}
				</div>
			</section>
		)}
	</main>
</div>

<style>
	:root {
		/* LSJ brand palette */
		--color-ink-1000: #0b0b0d;
		--color-ink-800: #232329;
		--color-ink-500: #686873;
		--color-surface-0: #f6f5f2;
		--color-surface-100: #eceae4;
		--color-accent-900: #121217;
		--color-accent-0: #f9f8f5;
		--color-rule: rgba(18, 18, 23, 0.18);

		/* Type scale */
		--fs-headline: clamp(2.2rem, 6.5vw, 5.5rem);
		--fs-subhead: clamp(1rem, 1.5vw, 1.25rem);
		--fs-body: 0.95rem;
		--fs-meta: 0.72rem;

		/* Spacing + radius */
		--space-1: 0.4rem;
		--space-2: 0.8rem;
		--space-3: 1.2rem;
		--space-4: 1.8rem;
		--space-5: 2.7rem;
		--space-6: 4.2rem;
		--radius-sm: 8px;
		--radius-md: 12px;

		/* Shadow tokens */
		--shadow-soft: 0 16px 32px rgba(9, 9, 12, 0.06);
		--shadow-cta: 0 8px 16px rgba(10, 10, 14, 0.28);
	}

	#container {
		min-height: 100%;
		font-family: Inter, 'Helvetica Neue', Arial, sans-serif;
		color: var(--color-ink-1000);
		background: linear-gradient(180deg, var(--color-surface-0) 0%, var(--color-surface-100) 100%);
	}

	main {
		display: grid;
		grid-template-columns: minmax(0, 1.2fr) minmax(260px, 1fr) minmax(280px, 1fr);
		gap: var(--space-6);
		min-height: 100vh;
		padding: var(--space-6) clamp(1.2rem, 4vw, 5rem);
		align-items: end;
	}

	#masthead {
		grid-column: 1 / -1;
		display: flex;
		justify-content: space-between;
		align-items: baseline;
		gap: var(--space-3);
		padding-bottom: var(--space-3);
		border-bottom: 1px solid var(--color-rule);
	}

	.wordmark {
		margin: 0;
		font-family: Didot, 'Bodoni MT', 'Iowan Old Style', 'Times New Roman', serif;
		font-size: clamp(1.5rem, 2.4vw, 2.4rem);
		font-weight: 500;
		letter-spacing: 0.2em;
		line-height: 0.95;
		text-transform: uppercase;
	}

	.primary-nav {
		display: flex;
		flex-wrap: wrap;
		gap: var(--space-3);
	}

	.primary-nav a {
		font-size: var(--fs-meta);
		letter-spacing: 0.12em;
		text-transform: uppercase;
		text-decoration: none;
		color: var(--color-ink-800);
		padding-bottom: 0.15rem;
		border-bottom: 1px solid transparent;
	}

	.primary-nav a:hover {
		border-color: var(--color-rule);
	}

	#hero {
		display: grid;
		gap: var(--space-3);
		padding-right: clamp(0rem, 5vw, 3rem);
	}

	#hero-media {
		position: relative;
		min-height: 22rem;
	}

	.hero-media-grid {
		display: grid;
		grid-template-rows: minmax(20rem, 1fr) auto;
		gap: var(--space-2);
	}

	.media-frame {
		position: relative;
		margin: 0;
		border-radius: var(--radius-md);
		overflow: hidden;
		border: 1px solid var(--color-rule);
		box-shadow: var(--shadow-soft);
		background: #111;
	}

	.media-frame img {
		width: 100%;
		height: 100%;
		min-height: 20rem;
		object-fit: cover;
		display: block;
		filter: saturate(0.88) contrast(1.02);
	}

	.media-frame::after {
		content: '';
		position: absolute;
		inset: 0;
		background: linear-gradient(180deg, rgba(0, 0, 0, 0.18) 0%, rgba(0, 0, 0, 0.38) 100%);
		pointer-events: none;
	}

	.media-frame figcaption {
		position: absolute;
		left: var(--space-2);
		bottom: var(--space-2);
		margin: 0;
		z-index: 2;
		font-size: var(--fs-meta);
		letter-spacing: 0.14em;
		text-transform: uppercase;
		color: rgba(249, 248, 245, 0.88);
	}

	.media-frame-secondary img {
		min-height: 12rem;
	}

	.media-fallback {
		display: grid;
		place-items: end start;
		padding: var(--space-3);
		min-height: 20rem;
		border-radius: var(--radius-md);
		border: 1px solid var(--color-rule);
		background:
			linear-gradient(140deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0)),
			linear-gradient(180deg, #1c1c1f 0%, #0d0d10 100%);
	}

	.media-fallback p {
		margin: 0;
		font-size: var(--fs-meta);
		letter-spacing: 0.14em;
		text-transform: uppercase;
		color: rgba(249, 248, 245, 0.75);
	}

	[data-view='gallery'] #hero {
		align-content: start;
	}

	[data-view='home'] #hero-media {
		display: none;
	}

	[data-view='gallery'] #hero-media {
		display: block;
	}

	.meta {
		margin: 0;
		font-size: var(--fs-meta);
		font-weight: 600;
		letter-spacing: 0.16em;
		text-transform: uppercase;
		color: var(--color-ink-500);
	}

	.meta-soft {
		letter-spacing: 0.08em;
	}

	h1 {
		margin: 0;
		font-size: var(--fs-headline);
		font-weight: 500;
		line-height: 0.95;
		letter-spacing: -0.03em;
		max-width: 12ch;
	}

	.inscription {
		margin: var(--space-1) 0 0;
		font-size: var(--fs-subhead);
		letter-spacing: 0.01em;
		color: var(--color-ink-800);
	}

	#actions {
		display: flex;
		align-items: center;
		gap: var(--space-2);
		flex-wrap: wrap;
		margin-top: var(--space-2);
	}

	#actions a {
		font-size: var(--fs-body);
		font-weight: 600;
		text-decoration: none;
	}

	.button {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		min-width: 7rem;
		padding: 0.78rem 1.35rem;
		border-radius: var(--radius-sm);
		background: var(--color-accent-900);
		color: var(--color-accent-0);
		box-shadow: var(--shadow-cta);
		transition: transform 0.2s ease, box-shadow 0.2s ease;
	}

	.button:hover {
		transform: translateY(-1px);
		box-shadow: 0 12px 20px rgba(10, 10, 14, 0.34);
	}

	.contact {
		padding: 0.78rem 0;
		color: var(--color-ink-800);
		border-bottom: 1px solid transparent;
	}

	.contact:hover {
		border-color: var(--color-rule);
	}

	#hero {
		grid-column: 1;
	}

	#hero-media {
		grid-column: 2;
	}

	#registry,
	#selected-records {
		grid-column: 3;

		display: grid;
		gap: var(--space-3);
		padding: var(--space-4);
		background: rgba(249, 248, 245, 0.86);
		border: 1px solid var(--color-rule);
		border-radius: var(--radius-md);
		box-shadow: var(--shadow-soft);
	}

	.registry-topline {
		display: flex;
		justify-content: space-between;
		align-items: baseline;
		gap: var(--space-2);
	}

	.taxonomy {
		display: grid;
		gap: var(--space-2);
		padding-top: var(--space-2);
		border-top: 1px solid var(--color-rule);
	}

	.filters {
		display: grid;
		grid-template-columns: repeat(2, minmax(0, 1fr));
		gap: var(--space-2);
	}

	.filter-group {
		display: grid;
		gap: var(--space-1);
	}

	.filter-label {
		margin: 0;
		font-size: var(--fs-meta);
		color: var(--color-ink-500);
		text-transform: uppercase;
		letter-spacing: 0.08em;
	}

	.chips {
		display: flex;
		flex-wrap: wrap;
		gap: 0.35rem;
	}

	.chip {
		display: inline-flex;
		padding: 0.2rem 0.55rem;
		font-size: 0.74rem;
		letter-spacing: 0.05em;
		text-transform: uppercase;
		border: 1px solid var(--color-rule);
		border-radius: 999px;
	}

	.records,
	.selected-grid {
		display: grid;
		gap: var(--space-2);
	}

	.record,
	.selected-item {
		display: grid;
		gap: var(--space-2);
		padding-top: var(--space-2);
		border-top: 1px solid var(--color-rule);
	}

	.record-kicker {
		margin: 0;
		font-size: var(--fs-body);
		font-weight: 600;
	}

	.record-line {
		display: grid;
		grid-template-columns: 6rem 1fr;
		gap: var(--space-2);
		margin: 0;
		font-size: var(--fs-body);
		line-height: 1.45;
	}

	.record-line span:first-child {
		color: var(--color-ink-500);
	}

	.inscription-secondary {
		margin-top: var(--space-2);
		padding-top: var(--space-2);
		border-top: 1px solid var(--color-rule);
		font-size: var(--fs-body);
		color: var(--color-ink-500);
	}

	@media (max-width: 920px) {
		main {
			grid-template-columns: 1fr;
			gap: var(--space-5);
			align-items: start;
		}

		#hero,
		#hero-media,
		#registry,
		#selected-records {
			grid-column: 1 / -1;
		}

		h1 {
			max-width: 100%;
		}
	}

	@media (max-width: 700px) {
		.filters {
			grid-template-columns: 1fr;
		}

		.hero-media-grid {
			grid-template-rows: auto;
		}
	}

	@media (max-width: 560px) {
		#masthead {
			flex-direction: column;
			align-items: start;
		}

		.primary-nav {
			gap: var(--space-2);
		}

		#actions {
			display: grid;
			grid-template-columns: 1fr;
		}

		.button,
		.contact {
			width: 100%;
			text-align: center;
		}

		.registry-topline {
			flex-direction: column;
			align-items: start;
		}

		.record-line {
			grid-template-columns: 1fr;
			gap: var(--space-1);
		}
	}
</style>

